{% extends "base.html" %}

{% block title %}Historial de Ventas{% endblock %}

{% block content %}
<section class="historial-section">
    
    <h1 class="titulo-seccion">Historial de Ventas</h1>

    {% if ventas %}
        {% for venta in ventas %}
            <div class="venta-card">

                <p><strong>Venta ID:</strong> {{ venta['id'] }}</p>
                <p><strong>Fecha:</strong> {{ venta['fecha'] }}</p>
                <p><strong>Cliente:</strong> {{ venta['cliente_nombre'] }}</p>

                <p><strong>Productos comprados:</strong></p>
                <ul class="detalle-venta">
                    {% for item in ventas_detalle[venta['id']] %}
                        <li>
                            {{ item['nombre'] }} â€” 
                            Cantidad: {{ item['cantidad'] }} â€” 
                            Precio unitario: ${{ "%.2f"|format(item['precio']) }}
                        </li>
                    {% endfor %}
                </ul>

                <br>

                <!-- BOTÃ“N DE FACTURA -->
                <a href="{{ url_for('factura', id=venta['id']) }}" class="btn-principal">
                    ğŸ§¾ Descargar Factura
                </a>

                <!-- BOTÃ“N DE ELIMINAR VENTA -->
                <a href="{{ url_for('eliminar_venta', id=venta['id']) }}"
                   class="btn-eliminar-venta"
                   onclick="return confirm('Â¿Seguro deseas eliminar esta venta? Esta acciÃ³n no se puede deshacer.');">
                    ğŸ—‘ï¸ Eliminar Venta
                </a>

            </div>
        {% endfor %}
    {% else %}
        <p class="mensaje-sin-datos">No hay ventas registradas.</p>
    {% endif %}

    <a href="{{ url_for('index') }}" class="btn-volver">â† Volver al inicio</a>
</section>
{% endblock %}
